<!DOCTYPE html>
<html lang="az">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>SMM PRO</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg-color: #000000;
            --text-color: #ffffff;
            --accent-color: #00d2ff;
            --card-bg: rgba(255, 255, 255, 0.05);
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 0;
            font-family: 'Poppins', sans-serif;
            overflow: hidden;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* INTRO & ROCKET */
        #intro {
            position: fixed; inset: 0; background: #000; z-index: 1000;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            transition: opacity 0.8s ease;
        }
        .rocket-img { width: 80px; animation: fly 3s ease-in-out forwards; }
        @keyframes fly {
            0% { transform: translateY(200px); opacity: 0; }
            50% { opacity: 1; }
            100% { transform: translateY(-500px); opacity: 0; }
        }

        /* HEADER */
        header {
            padding: 15px;
            text-align: center;
            border-bottom: 1px solid #1a1a1a;
            background: rgba(0,0,0,0.8);
            backdrop-filter: blur(10px);
        }
        .logo { font-size: 20px; font-weight: 800; letter-spacing: 4px; color: var(--accent-color); }

        /* √úST: PROQRAMLAR */
        .category-bar {
            display: flex; overflow-x: auto; padding: 15px; gap: 20px;
            background: #050505; border-bottom: 1px solid #111;
            scrollbar-width: none;
        }
        .category-bar::-webkit-scrollbar { display: none; }
        .cat-item {
            min-width: 60px; text-align: center; opacity: 0.4; transition: 0.3s;
        }
        .cat-item.active { opacity: 1; color: var(--accent-color); transform: scale(1.1); }
        .cat-item img { width: 40px; height: 40px; border-radius: 10px; margin-bottom: 5px; }
        .cat-item span { font-size: 10px; font-weight: bold; display: block; }

        /* ORTA: MARKET */
        #market {
            flex: 1; overflow-y: auto; padding: 15px;
            background: radial-gradient(circle at top, #0a0a0a, #000);
        }
        .service-card {
            background: var(--card-bg); border: 1px solid rgba(255,255,255,0.05);
            border-radius: 15px; padding: 15px; margin-bottom: 12px;
            display: flex; justify-content: space-between; align-items: center;
            backdrop-filter: blur(5px);
        }
        .service-info h4 { margin: 0; font-size: 14px; }
        .service-info p { margin: 5px 0 0; color: #00ff88; font-weight: bold; }
        .buy-btn {
            background: var(--accent-color); color: #000; border: none;
            padding: 8px 16px; border-radius: 8px; font-weight: bold; font-size: 11px;
        }

        /* ALT: TARƒ∞X√á∆è */
        #history {
            height: 160px; background: #050505; border-top: 1px solid #1a1a1a;
            padding: 15px; overflow-y: auto;
        }
        .history-title { font-size: 11px; color: #444; text-transform: uppercase; margin-bottom: 10px; }
        .history-item {
            display: flex; justify-content: space-between; padding: 8px 0;
            border-bottom: 1px solid #0f0f0f; font-size: 11px;
        }
    </style>
</head>
<body onclick="initAudio()">

    <audio id="sfx-rocket" src="https://www.soundjay.com/transportation/sounds/airplane-fly-by-01.mp3"></audio>
    <audio id="bg-music" loop src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-15.mp3"></audio>

    <div id="intro">
        <img src="https://cdn-icons-png.flaticon.com/png/512/3132/premium/3132693.png" class="rocket-img">
        <h2 style="color: #00d2ff; letter-spacing: 3px; margin-top: 20px;">SMM PRO</h2>
    </div>

    <header>
        <div class="logo">SMM PRO</div>
    </header>

    <div class="category-bar">
        <div class="cat-item active" onclick="filter('Instagram', this)">
            <img src="https://cdn-icons-png.flaticon.com/512/2111/2111463.png"><span>Instagram</span>
        </div>
        <div class="cat-item" onclick="filter('Tiktok', this)">
            <img src="https://cdn-icons-png.flaticon.com/512/3046/3046121.png"><span>TikTok</span>
        </div>
        <div class="cat-item" onclick="filter('Telegram', this)">
            <img src="https://cdn-icons-png.flaticon.com/512/2111/2111646.png"><span>Telegram</span>
        </div>
        <div class="cat-item" onclick="filter('Youtube', this)">
            <img src="https://cdn-icons-png.flaticon.com/512/1384/1384060.png"><span>YouTube</span>
        </div>
    </div>

    <main id="market"></main>

    <footer id="history">
        <div class="history-title">üïí Son ∆èm…ôliyyatlarƒ±nƒ±z</div>
        <div id="hist-list">
            <p style="opacity:0.2; font-size:10px;">He√ß bir m…ôlumat tapƒ±lmadƒ±.</p>
        </div>
    </footer>

    <script>
        let tg = window.Telegram.WebApp;
        let services = [];
        tg.expand();
        tg.ready();

        let audioStarted = false;
        function initAudio() {
            if(!audioStarted) {
                document.getElementById('sfx-rocket').play().catch(()=>{});
                setTimeout(() => {
                    let bg = document.getElementById('bg-music');
                    bg.volume = 0.3;
                    bg.play().catch(()=>{});
                }, 1500);
                audioStarted = true;
            }
        }

        window.onload = () => {
            const params = new URLSearchParams(window.location.search);
            const dataStr = params.get('data');
            
            if(dataStr) {
                const data = JSON.parse(decodeURIComponent(dataStr));
                services = data.services;
                renderHistory(data.history);
                filter('Instagram');
            }

            setTimeout(() => {
                const intro = document.getElementById('intro');
                intro.style.opacity = '0';
                setTimeout(() => intro.remove(), 800);
            }, 3000);
        };

        function filter(cat, el) {
            if(el) {
                document.querySelectorAll('.cat-item').forEach(i => i.classList.remove('active'));
                el.classList.add('active');
            }
            const container = document.getElementById('market');
            container.innerHTML = "";
            
            const filtered = services.filter(s => s.cat === cat);
            if(filtered.length === 0) {
                container.innerHTML = "<p style='text-align:center; opacity:0.3; margin-top:40px;'>Xidm…ôt yoxdur.</p>";
                return;
            }

            filtered.forEach(s => {
                container.innerHTML += `
                    <div class="service-card">
                        <div class="service-info">
                            <h4>${s.name}</h4>
                            <p>${s.rate} AZN</p>
                        </div>
                        <button class="buy-btn" onclick="order('${s.id}')">Sƒ∞FARƒ∞≈û</button>
                    </div>`;
            });
        }

        function renderHistory(h) {
            const list = document.getElementById('hist-list');
            if(h && h.length > 0) {
                list.innerHTML = "";
                h.forEach(item => {
                    list.innerHTML += `<div class="history-item"><span>${item.act}</span><span style="opacity:0.3">${item.dt}</span></div>`;
                });
            }
        }

        function order(id) {
            tg.showConfirm("Sifari≈ü t…ôsdiql…ônsin?", (ok) => {
                if(ok) {
                    tg.sendData("order_" + id);
                    tg.close();
                }
            });
        }

        // M√∂vzu d…ôyi≈ü…ônd…ô Telegram r…ôngl…ôrin…ô uyƒüunla≈üma
        tg.onEvent('themeChanged', () => {
            document.body.style.setProperty('--bg-color', tg.backgroundColor);
        });
    </script>
</body>
</html>
